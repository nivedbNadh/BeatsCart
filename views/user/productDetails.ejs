<%-include('../layouts/user/header')%>

<%-include('../layouts/user/navbar')%>
  <!-- Header part end-->
 

<section class="product_list section_padding">
  <div class="container">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
          <% breadcrumbs.forEach(function(breadcrumb, index) { %>
              <% if (index === breadcrumbs.length - 1) { %>
                  <li class="breadcrumb-item active" aria-current="page"><%= breadcrumb.name %></li>
              <% } else { %>
                  <li class="breadcrumb-item"><a href="<%= breadcrumb.url %>"><%= breadcrumb.name %></a></li>
              <% } %>
          <% }); %>
      </ol>
  </nav>

</head>
<body>
  
<!--breadcrumbs-->
 
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <div class="product-image image_zoom">

          <img id="mainProductImage" src="/uploads/<%= product[0].image[0] %>" alt="Product Image">
        </div>
      </div>
      <div class="col-md-6"> 
        <div class="product-info">
          <h1 class="product-title">Product Name: <%= product[0].name %></h1>
          <h1 id="product-id" data-id="<%= product[0].id %>"></h1>

          <p class="product-price">Price: <span>&#8377</span><%= product[0].price %></p>
          <p class="product-description">Description:<%= product[0].description %></p>


          <p class="product-stock">
            <% if (product[0].quantity > 10) {%>
              <span class="text-success"> In Stock</span>
            <%} else if (product[0].quantity > 0) {%>
              <span class="text-warning">Limited Stock</span>
            <%} else { %>
              <span class="text-danger"> Out of Stock</span>

            <%} %>
          </p>
          <div class="quantity-controls">
            <a href="/addToCart/:productId">

              <button class="btn btn-primary ml-3 add-to-cart-btn">Add to Cart</button>
            </a>
            <a href="#"><i class="fas fa-heart wishlist-icon"></i></a>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Small card section -->
    <div class="row other-images">
      <% for (let i = 1; i < product[0].image.length; i++) { %>
        <div class="col-md-3 col-sm-6"> 
          <div class="other-image-card">
            <!-- Added data-index attribute -->
            <img src="/uploads/<%= product[0].image[i] %>" class="card-img-top other-image" alt="Other Image" data-index="<%= i %>">
          </div>
        </div>
      <% } %>
    </div>
  </div>


  <style>
  
    /* Custom styles */
    body {
      font-family: Arial, sans-serif;
      background-color: white; 
      padding-top: 20px;
    }
    
    .product-image {
      max-width: 300px; 
      margin: 0 auto; 
      overflow: hidden; 
    }
    
    .product-image img {
      width: 100%; 
      height: auto; 
      display: block; 
      border: 1px solid #dee2e6; 
      border-radius: 5px; 
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); 
    }
    
    
    /* .product-info { */
      /* background-color: #fff;  */
      /* border: 1px solid #dee2e6;  */
      /* border-radius: 5px; */
      /* padding: 20px; */
    /* } */
    
    .product-title {
      font-size: 24px;
      font-weight: bold;
    }
    
    .product-price {
      font-size: 18px;
      color: #007bff;
    }
    
    .product-description {
      margin-top: 10px;
      color: #495057; 
    }
    
    .image_zoom{
      overflow: hidden
    }
    
    .image_zoom img{
      transform: scale(var(--zoom));
      transform-origin: var(--x) var(--y);
      transition: transform 0.3s ease;
    
    }
    .image_zoom:hover{
      cursor: zoom-in;
      --zoom:3;
    }
    .quantity-controls {
      margin-top: 20px;
    }
    
    .other-images {
      margin-top: 20px; 
    }
    
    .other-image-card {
      margin-bottom: 20px; 
    }
    
    .other-image-card img {
      width: 100%; 
      border-radius: 5px;
      border: 1px solid #dee2e6; 
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); 
    }
    
    
    @media (min-width: 768px) {
        .col-md-3 {
          margin-left: 112px;
            -ms-flex: 0 0 25%;
            flex: 0 0 25%;
            max-width: 10%;
        }
    }
    
    .other-images .col-md-3 {
        margin-right: -111px;
        margin-bottom: 0;
    }
    
    .other-images .col-md-3 {
      margin-bottom: 0;
    }
    
    @media screen and (max-width: 768px) {
      .product-info,
      .quantity-controls {
        margin-top: 30px;
      }
    }
    .breadcrumb {
        background-color: transparent; 
        padding: 0; 
        margin: 0; 
    }
    
    .breadcrumb .breadcrumb-item {
        font-size: 16px; 
        color: #555; 
    }
    
    .breadcrumb .breadcrumb-item a {
        color: #007bff; 
        text-decoration: none; 
        transition: color 0.3s;
    }
    
    .breadcrumb .breadcrumb-item a:hover {
        color: #0056b3;
    }
    
    .breadcrumb .breadcrumb-item.active {
        color: #000; 
              }
    </style>

 <!--::footer_part start::-->
 <%-include('../layouts/user/footer')%>
 <!--::footer_part end::-->

</body>
</html>



<script>
  document.querySelectorAll('.image_zoom').forEach(element => {
  let x, y, width, height;
  element.onmouseenter = () => {
    const size = element.getBoundingClientRect();
    x = size.x;
    y = size.y;
    width = size.width;
    height = size.height;
  };
  element.onmousemove = e => {
    const horizontal = (e.clientX - x) / width * 100;
    const vertical = (e.clientY - y) / height * 100;

    element.style.setProperty('--x', horizontal + '%');
    element.style.setProperty('--y', vertical + '%');
  };
});

document.addEventListener("DOMContentLoaded", function() {
  const mainProductImage = document.getElementById('mainProductImage');

  const otherImages = document.querySelectorAll('.other-image');
  otherImages.forEach(function(image) {
    image.addEventListener('click', function() {
      mainProductImage.src = this.src;
    });
  });
});



  
</script>
<script>
  document.querySelector('.add-to-cart-btn').addEventListener('click', function() {
    const productId = document.getElementById('product-id').dataset.id;

    fetch('/addToCart/' + productId, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok ' + response.statusText);
      }
      return response.json();
    })
    .then(data => {
      console.log('Success:', data);

      // Redirect to the same page
      window.location.href = window.location.href; // This will reload the page
    })
    .catch(error => {
      console.error('Error adding product to cart:', error);
    });
  });
</script>

